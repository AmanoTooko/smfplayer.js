/** @license smfplayer.js 2013 - imaya / GREE Inc. [ https://github.com/gree/smfplayer.js ] The MIT License */(function() {'use strict';var h=this;function k(f,d){var e=f.split("."),b=h;e[0]in b||!b.execScript||b.execScript("var "+e[0]);for(var a;e.length&&(a=e.shift());)e.length||void 0===d?b=b[a]?b[a]:b[a]={}:b[a]=d}function q(f){var d=r;function e(){}e.prototype=d.prototype;f.m=d.prototype;f.prototype=new e;f.l=function(b,a,e){return d.prototype[a].apply(b,Array.prototype.slice.call(arguments,2))}};var s=void 0!==h.Uint8Array&&void 0!==h.Uint16Array&&void 0!==h.Uint32Array;function r(f,d,e){this.b=f;this.time=e}function t(f,d,e,b,a,n){this.b=f;this.time=e;this.channel=b;this.i=a;this.f=n}q(t);function u(f,d,e,b){this.b=f;this.time=e;this.data=b}q(u);function y(f,d,e,b){this.b=f;this.time=e;this.data=b}q(y);function z(f,d){d=d||{};this.input=f;this.a=d.index||0;this.length=d.length||f.length-this.a;this.offset=this.a;this.padding=void 0!==d.padding?d.padding:!0;this.g=void 0!==d.bigEndian?d.bigEndian:!1}
z.prototype.parse=function(){var f=this.length+this.offset;for(this.e=[];this.a<f;){var d=this.input,e=this.a,b=void 0;this.e.push({type:String.fromCharCode(d[e++],d[e++],d[e++],d[e++]),size:b=this.g?(d[e++]<<24|d[e++]<<16|d[e++]<<8|d[e++])>>>0:(d[e++]|d[e++]<<8|d[e++]<<16|d[e++]<<24)>>>0,offset:e});e+=b;this.padding&&1===(e-this.offset&1)&&e++;this.a=e}};function A(f,d){var e=f.e[d];return void 0===e?null:e};function D(f,d){d=d||{};d.padding=!1;d.bigEndian=!0;this.input=f;this.a=d.index||0;this.d=0;this.c=new z(f,d);this.k=[];this.j=[]}D.prototype.parse=function(){var f,d;this.c.parse();f=A(this.c,this.d++);d=this.input;var e=f.offset;if(!f||"MThd"!==f.type)throw Error("invalid header signature");e++;e++;this.h=d[e++]<<8|d[e++];f=0;for(d=this.h;f<d;++f)E(this)};
function E(f){function d(){var c=0,d;do d=b[a++],c=c<<7|d&127;while(0!==(d&128));return c}var e=A(f.c,f.d++),b=f.input,a=e.offset,n,l,p,v=-1,w=-1,c,g=0,m;if(!e||"MTrk"!==e.type)throw Error("invalid header signature");for(var e=e.offset+e.size,B=[],C=[];a<e;){n=d();g+=n;m=a;n=b[a++];l=n>>4&15;p=n&15;8>l?(l=v,p=w,n=v<<4|w,a--,m--):(v=l,w=p);var x=[,,,,,,,,"NoteOff","NoteOn","NoteAftertouch","ControlChange","ProgramChange","ChannelAftertouch","PitchBend"];switch(l){case 8:case 9:case 10:case 11:case 13:case 14:c=
new t(x[l],0,g,p,b[a++],b[a++]);break;case 12:c=new t(x[l],0,g,p,b[a++]);break;case 15:switch(p){case 0:c=d();if(247!==b[a+c-1])throw Error("invalid SysEx event");c=new u("SystemExclusive",0,g,s?b.subarray(a,(a+=c)-1):b.slice(a,(a+=c)-1));break;case 7:c=d();c=new u("SystemExclusive(F7)",0,g,s?b.subarray(a,a+=c):b.slice(a,a+=c));break;case 15:l=b[a++];c=d();switch(l){case 0:c=new y("SequenceNumber",0,g,[b[a++],b[a++]]);break;case 1:c=new y("TextEvent",0,g,[String.fromCharCode.apply(null,s?b.subarray(a,
a+=c):b.slice(a,a+=c))]);break;case 2:c=new y("CopyrightNotice",0,g,[String.fromCharCode.apply(null,s?b.subarray(a,a+=c):b.slice(a,a+=c))]);break;case 3:c=new y("SequenceTrackName",0,g,[String.fromCharCode.apply(null,s?b.subarray(a,a+=c):b.slice(a,a+=c))]);break;case 4:c=new y("InstrumentName",0,g,[String.fromCharCode.apply(null,s?b.subarray(a,a+=c):b.slice(a,a+=c))]);break;case 5:c=new y("Lyrics",0,g,[String.fromCharCode.apply(null,s?b.subarray(a,a+=c):b.slice(a,a+=c))]);break;case 6:c=new y("Marker",
0,g,[String.fromCharCode.apply(null,s?b.subarray(a,a+=c):b.slice(a,a+=c))]);break;case 7:c=new y("CuePoint",0,g,[String.fromCharCode.apply(null,s?b.subarray(a,a+=c):b.slice(a,a+=c))]);break;case 32:c=new y("MidiChannelPrefix",0,g,[b[a++]]);break;case 47:c=new y("EndOfTrack",0,g,[]);break;case 81:c=new y("SetTempo",0,g,[b[a++]<<16|b[a++]<<8|b[a++]]);break;case 84:c=new y("SmpteOffset",0,g,[b[a++],b[a++],b[a++],b[a++],b[a++]]);break;case 88:c=new y("TimeSignature",0,g,[b[a++],b[a++],b[a++],b[a++]]);
break;case 89:c=new y("KeySignature",0,g,[b[a++],b[a++]]);break;case 127:c=new y("SequencerSpecific",0,g,[s?b.subarray(a,a+=c):b.slice(a,a+=c)]);break;default:c=new y("Unknown",0,g,[l,s?b.subarray(a,a+=c):b.slice(a,a+=c)])}break;default:h.console.log("unknown message:",n.toString(16))}break;default:throw Error("invalid status");}l=a-m;m=s?b.subarray(m,m+l):b.slice(m,m+l);m[0]=n;c instanceof t&&"NoteOn"===c.b&&0===c.f&&(c.b=x[8],m=[128|c.channel,c.i,c.f],s&&(m=new Uint8Array(m)));C.push(m);B.push(c)}f.k.push(B);
f.j.push(C)};k("SMF.Parser",D);k("SMF.Parser.prototype.parse",D.prototype.parse);}).call(this); //@ sourceMappingURL=smf.parser.min.js.map
