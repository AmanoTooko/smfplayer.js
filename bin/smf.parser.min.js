/** @license smfplayer.js 2013 - imaya / GREE Inc. [ https://github.com/gree/smfplayer.js ] The MIT License */(function() {var k=this;function r(c,f){c=c.split(".");var d=k;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var b;c.length&&(b=c.shift());)c.length||void 0===f?d[b]?d=d[b]:d=d[b]={}:d[b]=f}function t(c,f){function d(){}d.prototype=f.prototype;c.m=f.prototype;c.prototype=new d;c.prototype.constructor=c;c.l=function(b,a,c){for(var d=Array(arguments.length-2),g=2;g<arguments.length;g++)d[g-2]=arguments[g];return f.prototype[a].apply(b,d)}};function v(c,f){f=f||{};this.c=c;this.a=f.index||0;this.length=f.length||c.length-this.a;this.offset=this.a;this.padding=void 0!==f.padding?f.padding:!0;this.f=void 0!==f.f?f.f:!1}function w(c,f){c=c.b[f];return void 0===c?null:c};function x(c,f,d){this.a=c;this.time=d}function z(c,f,d,b,a,n){this.a=c;this.time=d;this.c=b;this.g=a;this.b=n}t(z,x);function A(c,f,d,b){this.a=c;this.time=d;this.data=b}t(A,x);function B(c,f,d,b){this.a=c;this.time=d;this.data=b}t(B,x);function E(c,f){f=f||{};f.padding=!1;f.f=!0;this.b=c;this.c=0;this.a=new v(c,f);this.j=[];this.i=[]}
E.prototype.g=function(){var c=this.a;var f=c.length+c.offset;for(c.b=[];c.a<f;){var d=c;var b=d.c;var a=d.a;d.b.push({type:String.fromCharCode(b[a++],b[a++],b[a++],b[a++]),size:b=d.f?(b[a++]<<24|b[a++]<<16|b[a++]<<8|b[a++])>>>0:(b[a++]|b[a++]<<8|b[a++]<<16|b[a++]<<24)>>>0,offset:a});a+=b;d.padding&&1===(a-d.offset&1)&&a++;d.a=a}c=w(this.a,this.c++);f=this.b;d=c.offset;if(!c||"MThd"!==c.type)throw Error("invalid header signature");d++;d++;this.h=f[d++]<<8|f[d++];c=0;for(f=this.h;c<f;++c)F(this)};
function F(c){function f(){var c=0;do{var d=b[a++];c=c<<7|d&127}while(0!==(d&128));return c}var d=w(c.a,c.c++),b=c.b,a=d.offset,n=-1,u=-1,g=0;if(!d||"MTrk"!==d.type)throw Error("invalid header signature");d=d.offset+d.size;for(var C=[],D=[];a<d;){var h=f();g+=h;var m=a;var p=b[a++];var l=p>>4&15;var q=p&15;8>l?(l=n,q=u,p=n<<4|u,a--,m--):(n=l,u=q);var y=[,,,,,,,,"NoteOff","NoteOn","NoteAftertouch","ControlChange","ProgramChange","ChannelAftertouch","PitchBend"];switch(l){case 8:case 9:case 10:case 11:case 13:case 14:var e=
new z(y[l],h,g,q,b[a++],b[a++]);break;case 12:e=new z(y[l],h,g,q,b[a++]);break;case 15:switch(q){case 0:e=f();if(247!==b[a+e-1])throw Error("invalid SysEx event");e=new A("SystemExclusive",h,g,b.subarray(a,(a+=e)-1));break;case 7:e=f();e=new A("SystemExclusive(F7)",h,g,b.subarray(a,a+=e));break;case 15:l=b[a++];e=f();switch(l){case 0:e=new B("SequenceNumber",h,g,[b[a++],b[a++]]);break;case 1:e=new B("TextEvent",h,g,[String.fromCharCode.apply(null,b.subarray(a,a+=e))]);break;case 2:e=new B("CopyrightNotice",
h,g,[String.fromCharCode.apply(null,b.subarray(a,a+=e))]);break;case 3:e=new B("SequenceTrackName",h,g,[String.fromCharCode.apply(null,b.subarray(a,a+=e))]);break;case 4:e=new B("InstrumentName",h,g,[String.fromCharCode.apply(null,b.subarray(a,a+=e))]);break;case 5:e=new B("Lyrics",h,g,[String.fromCharCode.apply(null,b.subarray(a,a+=e))]);break;case 6:e=new B("Marker",h,g,[String.fromCharCode.apply(null,b.subarray(a,a+=e))]);break;case 7:e=new B("CuePoint",h,g,[String.fromCharCode.apply(null,b.subarray(a,
a+=e))]);break;case 32:e=new B("MidiChannelPrefix",h,g,[b[a++]]);break;case 47:e=new B("EndOfTrack",h,g,[]);break;case 81:e=new B("SetTempo",h,g,[b[a++]<<16|b[a++]<<8|b[a++]]);break;case 84:e=new B("SmpteOffset",h,g,[b[a++],b[a++],b[a++],b[a++],b[a++]]);break;case 88:e=new B("TimeSignature",h,g,[b[a++],b[a++],b[a++],b[a++]]);break;case 89:e=new B("KeySignature",h,g,[b[a++],b[a++]]);break;case 127:e=new B("SequencerSpecific",h,g,[b.subarray(a,a+=e)]);break;default:e=new B("Unknown",h,g,[l,b.subarray(a,
a+=e)])}break;default:k.console.log("unknown message:",p.toString(16))}break;default:throw Error("invalid status");}h=a-m;m=b.subarray(m,m+h);m[0]=p;e instanceof z&&"NoteOn"===e.a&&0===e.b&&(e.a=y[8],m=new Uint8Array([128|e.c,e.g,e.b]));D.push(m);C.push(e)}c.j.push(C);c.i.push(D)};r("SMF.Parser",E);r("SMF.Parser.prototype.parse",E.prototype.g);}).call(this); //# sourceMappingURL=smf.parser.min.js.map
