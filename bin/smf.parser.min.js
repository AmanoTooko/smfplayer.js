/*! smfplayer.js vundefined | imaya / GREE Inc. / Logue | license: MIT */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Smf",[],t):"object"==typeof exports?exports.Smf=t():e.Smf=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);class n{constructor(e,t){t=t||{},this.input=e,this.ip=t.index||0,this.length=t.length||e.length-this.ip,this.chunkList,this.offset=this.ip,this.padding=void 0===t.padding||t.padding,this.bigEndian=void 0!==t.bigEndian&&t.bigEndian}parse(){var e=this.length+this.offset;for(this.chunkList=[];this.ip<e;)this.parseChunk()}parseChunk(){var e,t=this.input,r=this.ip;this.chunkList.push({type:String.fromCharCode(t[r++],t[r++],t[r++],t[r++]),size:e=this.bigEndian?(t[r++]<<24|t[r++]<<16|t[r++]<<8|t[r++])>>>0:(t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24)>>>0,offset:r}),r+=e,this.padding&&1==(r-this.offset&1)&&r++,this.ip=r}getChunk(e){var t=this.chunkList[e];return void 0===t?null:t}getNumberOfChunks(){return this.chunkList.length}}class s{constructor(e,t,r){this.subtype=e,this.deltaTime=t,this.time=r}}class a extends s{constructor(e,t,r,n,s,a){super(e,t,r),this.channel=n,this.parameter1=s,this.parameter2=a}}class i extends s{constructor(e,t,r,n){super(e,t,r),this.data=n}}class o extends s{constructor(e,t,r,n){super(e,t,r),this.data=n}}r.d(t,"default",function(){return u});class u{constructor(e,t={}){t.padding=!1,t.bigEndian=!0,this.input=e,this.ip=t.index||0,this.chunkIndex=0,this.riffParser_=new n(e,t),this.formatType=0,this.numberOfTracks=0,this.timeDivision=0,this.tracks=[],this.plainTracks=[]}parse(){let e=0,t=0;for(this.riffParser_.parse(),this.parseHeaderChunk(),e=0,t=this.numberOfTracks;e<t;++e)this.parseTrackChunk()}parseHeaderChunk(){const e=this.riffParser_.getChunk(this.chunkIndex++),t=this.input;let r=e.offset;if(!e||"MThd"!==e.type)throw new Error("invalid header signature");this.formatType=t[r++]<<8|t[r++],this.numberOfTracks=t[r++]<<8|t[r++],this.timeDivision=t[r++]<<8|t[r++]}parseTrackChunk(){const e=this.riffParser_.getChunk(this.chunkIndex++),t=this.input;let r,n,s=e.offset,u=0,c=0,h=0,f=0,p=-1,l=-1,d=0,b=0,k=0,y=0,m=0;const g=()=>{let e=0,r=0;do{e=e<<7|127&(r=t[s++])}while(0!=(128&r));return e};if(!e||"MTrk"!==e.type)throw new Error("invalid header signature");u=e.offset+e.size;let w=[],C=[];for(;s<u;){b+=c=g(),k=s,f=15&(m=t[s++]),(h=m>>4&15)<8?(h=p,f=l,m=p<<4|l,s--,k--):(p=h,l=f);const e=[,,,,,,,,"NoteOff","NoteOn","NoteAftertouch","ControlChange","ProgramChange","ChannelAftertouch","PitchBend"];switch(h){case 8:case 9:case 10:case 11:case 13:case 14:r=new a(e[h],c,b,f,t[s++],t[s++]);break;case 12:r=new a(e[h],c,b,f,t[s++]);break;case 15:switch(f){case 0:if(d=g(),247!==t[s+d-1])throw new Error("invalid SysEx event");r=new i("SystemExclusive",c,b,t.subarray(s,(s+=d)-1));break;case 7:d=g(),r=new i("SystemExclusive(F7)",c,b,t.subarray(s,s+=d));break;case 15:switch(h=t[s++],d=g(),h){case 0:r=new o("SequenceNumber",c,b,[t[s++],t[s++]]);break;case 1:r=new o("TextEvent",c,b,[String.fromCharCode.apply(null,t.subarray(s,s+=d))]);break;case 2:r=new o("CopyrightNotice",c,b,[String.fromCharCode.apply(null,t.subarray(s,s+=d))]);break;case 3:r=new o("SequenceTrackName",c,b,[String.fromCharCode.apply(null,t.subarray(s,s+=d))]);break;case 4:r=new o("InstrumentName",c,b,[String.fromCharCode.apply(null,t.subarray(s,s+=d))]);break;case 5:r=new o("Lyrics",c,b,[String.fromCharCode.apply(null,t.subarray(s,s+=d))]);break;case 6:r=new o("Marker",c,b,[String.fromCharCode.apply(null,t.subarray(s,s+=d))]);break;case 7:r=new o("CuePoint",c,b,[String.fromCharCode.apply(null,t.subarray(s,s+=d))]);break;case 32:r=new o("MidiChannelPrefix",c,b,[t[s++]]);break;case 47:r=new o("EndOfTrack",c,b,[]);break;case 81:r=new o("SetTempo",c,b,[t[s++]<<16|t[s++]<<8|t[s++]]);break;case 84:r=new o("SmpteOffset",c,b,[t[s++],t[s++],t[s++],t[s++],t[s++]]);break;case 88:r=new o("TimeSignature",c,b,[t[s++],t[s++],t[s++],t[s++]]);break;case 89:r=new o("KeySignature",c,b,[t[s++],t[s++]]);break;case 127:r=new o("SequencerSpecific",c,b,[t.subarray(s,s+=d)]);break;default:r=new o("Unknown",c,b,[h,t.subarray(s,s+=d)])}break;default:console.log("unknown message:",m.toString(16))}break;default:throw new Error("invalid status")}y=s-k,(n=t.subarray(k,k+y))[0]=m,r instanceof a&&"NoteOn"===r.subtype&&0===r.parameter2&&(r.subtype=e[8],n=new Uint8Array([128|r.channel,r.parameter1,r.parameter2])),C.push(n),w.push(r)}this.tracks.push(w),this.plainTracks.push(C)}}}])});