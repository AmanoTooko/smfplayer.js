/** @license sf2synth.js 2013 - imaya / GREE Inc. [ https://github.com/gree/sf2synth.js ] The MIT License */(function() {var l=this;function p(a,b){var c=a.split("."),d=l;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b};function w(a,b){b=b||{};this.c=a;this.b=b.index||0;this.length=b.length||a.length-this.b;this.offset=this.b;this.f=void 0!==b.padding?b.padding:!0;this.g=void 0!==b.bigEndian?b.bigEndian:!1}function ka(a,b,c){this.type=a;this.a=b;this.offset=c}
function B(a){var b=a.length+a.offset;for(a.a=[];a.b<b;){var c=a,d=c.c,e=c.b;c.a.push(new ka(String.fromCharCode(d[e++],d[e++],d[e++],d[e++]),d=c.g?(d[e++]<<24|d[e++]<<16|d[e++]<<8|d[e++])>>>0:(d[e++]|d[e++]<<8|d[e++]<<16|d[e++]<<24)>>>0,e));e+=d;c.f&&1===(e-c.offset&1)&&e++;c.b=e}}function N(a,b){var c=a.a[b];return void 0===c?null:c};function la(a){var b;b=b||{};this.a=a;this.j=b.parserOption}function ma(a,b){for(var c=a.a,d=b.offset,e=b.offset+b.a,f,g,m=[];d<e;){d+=2;f=c[d++]|c[d++]<<8;g=na[f];if(void 0===g)m.push({type:g,value:{code:f,C:c[d]|c[d+1]<<8<<16>>16,G:c[d++],F:c[d++]}});else switch(g){case "keyRange":case "velRange":case "keynum":case "velocity":m.push({type:g,value:{G:c[d++],F:c[d++]}});break;default:m.push({type:g,value:{C:c[d++]|c[d++]<<8<<16>>16}})}d+=2;d+=2}return m}
function Ea(a,b){for(var c=a.a,d=b.offset,e=b.offset+b.a,f,g,m=[];d<e;)if(f=c[d++]|c[d++]<<8,g=na[f],void 0===g)m.push({type:g,value:{code:f,C:c[d]|c[d+1]<<8<<16>>16,G:c[d++],F:c[d++]}});else switch(g){case "keynum":case "keyRange":case "velRange":case "velocity":m.push({type:g,value:{G:c[d++],F:c[d++]}});break;default:m.push({type:g,value:{C:c[d++]|c[d++]<<8<<16>>16}})}return m}
function Fa(a,b,c){var d=[],e={ra:[],keyRange:{F:127,G:0}},f;for(f=a;f<b;++f)a=c[f],d.push(a),"unknown"===a.type?e.ra.push(a.value):e[a.type]=a.value;return{N:e,O:d}}
var na=["startAddrsOffset","endAddrsOffset","startloopAddrsOffset","endloopAddrsOffset","startAddrsCoarseOffset","modLfoToPitch","vibLfoToPitch","modEnvToPitch","initialFilterFc","initialFilterQ","modLfoToFilterFc","modEnvToFilterFc","endAddrsCoarseOffset","modLfoToVolume",,"chorusEffectsSend","reverbEffectsSend","pan",,,,"delayModLFO","freqModLFO","delayVibLFO","freqVibLFO","delayModEnv","attackModEnv","holdModEnv","decayModEnv","sustainModEnv","releaseModEnv","keynumToModEnvHold","keynumToModEnvDecay",
"delayVolEnv","attackVolEnv","holdVolEnv","decayVolEnv","sustainVolEnv","releaseVolEnv","keynumToVolEnvHold","keynumToVolEnvDecay","instrument",,"keyRange","velRange","startloopAddrsCoarseOffset","keynum","velocity","initialAttenuation",,"endloopAddrsCoarseOffset","coarseTune","fineTune","sampleID","sampleModes",,"scaleTuning","exclusiveClass","overridingRootKey"];function Ga(a,b,c){void 0!==c.sample&&(this.c=a,this.v=b,this.o=c,this.h=c.key,this.J=c.velocity,this.u=c.sample,this.i=c.basePlaybackRate,this.sampleRate=c.sampleRate,this.D=c.volume,this.m=c.panpot,this.A=c.pitchBend,this.B=c.pitchBendSensitivity,this.I=c.modEnvToPitch,this.g=c.expression,this.s=a.currentTime,this.f=this.i,this.l=!1)}function Ha(a){return 440*Math.pow(2,(a-6900)/1200)}
function Ia(a){var b=a.o,c=a.j,d=a.b,e=a.c.currentTime,f=b.releaseTime-64,f=e+b.volRelease*d.gain.value*(1+f/(0>f?64:63)),g=a.w,m=Ha(b.initialFilterFc),n=Ha(b.initialFilterFc+b.modEnvToFilterFc),n=e+b.modRelease*(m===n?1:(g.frequency.value-m)/(n-m));if(a.H)switch(b.sampleModes){case 1:d.gain.cancelScheduledValues(0);d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(0,f);g.frequency.cancelScheduledValues(0);g.frequency.setValueAtTime(g.frequency.value,e);g.frequency.linearRampToValueAtTime(m,
n);c.playbackRate.cancelScheduledValues(0);c.playbackRate.setValueAtTime(c.playbackRate.value,e);c.playbackRate.linearRampToValueAtTime(a.f,n);c.stop(f);break;case 2:l.console.log("detect unused sampleModes");break;case 3:c.loop=!1}}Ga.prototype.connect=function(){this.b.connect(this.v)};
function Ja(a,b){a.f=a.i*Math.pow(Math.pow(2,1/12),b/(0>b?8192:8191)*a.B*a.o.scaleTuning);var c=a.j.playbackRate,d=a.f,e=a.s,f=a.o,g=e+f.modAttack,m=g+f.modDecay,n=d*Math.pow(Math.pow(2,1/12),a.I*a.o.scaleTuning);c.cancelScheduledValues(0);c.setValueAtTime(d,e);c.linearRampToValueAtTime(n,g);c.linearRampToValueAtTime(d+(n-d)*(1-f.modSustain),m)};function $a(a){var b;this.H=a;this.K=0;if(void 0!==l.AudioContext)a=new l.AudioContext;else if(void 0!==l.webkitAudioContext)a=new l.webkitAudioContext;else if(void 0!==l.mozAudioContext)a=new l.mozAudioContext;else throw Error("Web Audio not supported");void 0===a.createGainNode&&(a.createGainNode=a.createGain);this.c=a;this.i=this.c.createGain();this.J=this.c.createBufferSource();this.h=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.V=[127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127];this.S=
[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.A=[2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2];this.v=[127,127,127,127,127,127,127,127,127,127,127,127,127,127,127,127];this.U=[64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64];this.w=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.u=[0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0];this.m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.g=this.j=!1;this.R=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.f=[[],[],[],[],[],[],
[],[],[],[],[],[],[],[],[],[]];this.da=1/65535;this.b=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];this.l=Array(128);a=0;for(b=this.l.length;a<b;++a)this.l[a]=127;this.B=!0;this.D=this.c.createConvolver();this.s=this.c.createGain()}
var ab="Acoustic Piano;Bright Acoustic Piano;Electric Grand Piano;Honky-tonk Piano;Electric Piano;Electric Piano 2;Harpsichord;Clavi;Celesta;Glockenspiel;Musical box;Vibraphone;Marimba;Xylophone;Tubular Bell;Dulcimer;Drawbar Organ;Percussive Organ;Rock Organ;Church organ;Reed organ;Accordion;Harmonica;Tango Accordion;Acoustic Guitar (nylon);Acoustic Guitar (steel);Electric Guitar (jazz);Electric Guitar (clean);Electric Guitar (muted);Overdriven Guitar;Distortion Guitar;Guitar Harmonics;Acoustic Bass;Electric Bass (finger);Electric Bass (pick);Fretless Bass;Slap Bass 1;Slap Bass 2;Synth Bass 1;Synth Bass 2;Violin;Viola;Cello;Double bass;Tremolo Strings;Pizzicato Strings;Orchestral Harp;Timpani;String Ensemble 1;String Ensemble 2;Synth Strings 1;Synth Strings 2;Voice Aahs;Voice Oohs;Synth Voice;Orchestra Hit;Trumpet;Trombone;Tuba;Muted Trumpet;French horn;Brass Section;Synth Brass 1;Synth Brass 2;Soprano Sax;Alto Sax;Tenor Sax;Baritone Sax;Oboe;English Horn;Bassoon;Clarinet;Piccolo;Flute;Recorder;Pan Flute;Blown Bottle;Shakuhachi;Whistle;Ocarina;Lead 1 (square);Lead 2 (sawtooth);Lead 3 (calliope);Lead 4 (chiff);Lead 5 (charang);Lead 6 (voice);Lead 7 (fifths);Lead 8 (bass + lead);Pad 1 (new age);Pad 2 (warm);Pad 3 (polysynth);Pad 4 (choir);Pad 5 (bowed);Pad 6 (metallic);Pad 7 (halo);Pad 8 (sweep);FX 1 (rain);FX 2 (soundtrack);FX 3 (crystal);FX 4 (atmosphere);FX 5 (brightness);FX 6 (goblins);FX 7 (echoes);FX 8 (sci-fi);Sitar;Banjo;Shamisen;Koto;Kalimba;Bagpipe;Fiddle;Shanai;Tinkle Bell;Agogo;Steel Drums;Woodblock;Taiko Drum;Melodic Tom;Synth Drum;Reverse Cymbal;Guitar Fret Noise;Breath Noise;Seashore;Bird Tweet;Telephone Ring;Helicopter;Applause;Gunshot".split(";"),bb=
"Standard Set;;;;;;;;Room Set;;;;;;;;Power Set;;;;;;;;Electronic Set;Analog Set;;;;;;;Jazz Set;;;;;;;;Brush Set;;;;;;;;Orchestra Set;;;;;;;;SFX Set;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;".split(";");function cb(a){var b;a.X=new la(a.H);a.I=db(a);a.g=!1;a.j=!1;for(b=0;16>b;++b)eb(a,b,0),fb(a,b,100),gb(a,b,64),hb(a,b,0,64),ib(a,b,2),a.w[b]=!1,a.v[b]=127,a.u[b]=9===b?128:0,a.m[b]=0;for(b=0;128>b;++b)a.l[b]=127}
function db(a){var b,c,d,e,f,g,m,n,h=a.X,v=new w(h.a,h.j),z;B(v);if(1!==v.a.length)throw Error("wrong chunk length");z=N(v,0);if(null===z)throw Error("chunk not found");var x,y=h.a,C=z.offset,J;if("RIFF"!==z.type)throw Error("invalid chunk type:"+z.type);J=String.fromCharCode(y[C++],y[C++],y[C++],y[C++]);if("sfbk"!==J)throw Error("invalid signature:"+J);x=new w(y,{index:C,length:z.a-4});B(x);if(3!==x.a.length)throw Error("invalid sfbk structure");var O=N(x,0),D=h.a,U=O.offset,Ka;if("LIST"!==O.type)throw Error("invalid chunk type:"+
O.type);Ka=String.fromCharCode(D[U++],D[U++],D[U++],D[U++]);if("INFO"!==Ka)throw Error("invalid signature:"+Ka);B(new w(D,{index:U,length:O.a-4}));var oa=N(x,1),pa,V=h.a,W=oa.offset,La;if("LIST"!==oa.type)throw Error("invalid chunk type:"+oa.type);La=String.fromCharCode(V[W++],V[W++],V[W++],V[W++]);if("sdta"!==La)throw Error("invalid signature:"+La);pa=new w(V,{index:W,length:oa.a-4});B(pa);if(1!==pa.a.length)throw Error("TODO");h.h=N(pa,0);var qa=N(x,2),A,X=h.a,Y=qa.offset,Ma;if("LIST"!==qa.type)throw Error("invalid chunk type:"+
qa.type);Ma=String.fromCharCode(X[Y++],X[Y++],X[Y++],X[Y++]);if("pdta"!==Ma)throw Error("invalid signature:"+Ma);A=new w(X,{index:Y,length:qa.a-4});B(A);if(9!==A.a.length)throw Error("invalid pdta chunk");var Z=N(A,0),u=h.a,t=Z.offset,ic=h.l=[],jc=Z.offset+Z.a;if("phdr"!==Z.type)throw Error("invalid chunk type:"+Z.type);for(;t<jc;)ic.push({na:String.fromCharCode.apply(null,u.subarray(t,t+=20)),ma:u[t++]|u[t++]<<8,K:u[t++]|u[t++]<<8,ba:u[t++]|u[t++]<<8,ta:(u[t++]|u[t++]<<8|u[t++]<<16|u[t++]<<24)>>>
0,sa:(u[t++]|u[t++]<<8|u[t++]<<16|u[t++]<<24)>>>0,ua:(u[t++]|u[t++]<<8|u[t++]<<16|u[t++]<<24)>>>0});var aa=N(A,1),ra=h.a,ba=aa.offset,kc=h.m=[],lc=aa.offset+aa.a;if("pbag"!==aa.type)throw Error("invalid chunk type:"+aa.type);for(;ba<lc;)kc.push({ca:ra[ba++]|ra[ba++]<<8,P:ra[ba++]|ra[ba++]<<8});var Na=N(A,2);if("pmod"!==Na.type)throw Error("invalid chunk type:"+Na.type);h.g=ma(h,Na);var Oa=N(A,3);if("pgen"!==Oa.type)throw Error("invalid chunk type:"+Oa.type);h.f=Ea(h,Oa);var ca=N(A,4),Pa=h.a,da=ca.offset,
mc=h.o=[],nc=ca.offset+ca.a;if("inst"!==ca.type)throw Error("invalid chunk type:"+ca.type);for(;da<nc;)mc.push({ha:String.fromCharCode.apply(null,Pa.subarray(da,da+=20)),$:Pa[da++]|Pa[da++]<<8});var ea=N(A,5),sa=h.a,fa=ea.offset,oc=h.i=[],pc=ea.offset+ea.a;if("ibag"!==ea.type)throw Error("invalid chunk type:"+ea.type);for(;fa<pc;)oc.push({aa:sa[fa++]|sa[fa++]<<8,ga:sa[fa++]|sa[fa++]<<8});var Qa=N(A,6);if("imod"!==Qa.type)throw Error("invalid chunk type:"+Qa.type);h.c=ma(h,Qa);var Ra=N(A,7);if("igen"!==
Ra.type)throw Error("invalid chunk type:"+Ra.type);h.b=Ea(h,Ra);var ga=N(A,8),kb,ta,r=h.a,q=ga.offset,qc=h.oa=[],rc=h.pa=[],sc=ga.offset+ga.a,lb,ua,mb,va,wa,ha,nb,ob,pb,qb;if("shdr"!==ga.type)throw Error("invalid chunk type:"+ga.type);for(;q<sc;){lb=String.fromCharCode.apply(null,r.subarray(q,q+=20));ua=(r[q++]<<0|r[q++]<<8|r[q++]<<16|r[q++]<<24)>>>0;mb=(r[q++]<<0|r[q++]<<8|r[q++]<<16|r[q++]<<24)>>>0;va=(r[q++]<<0|r[q++]<<8|r[q++]<<16|r[q++]<<24)>>>0;wa=(r[q++]<<0|r[q++]<<8|r[q++]<<16|r[q++]<<24)>>>
0;ha=(r[q++]<<0|r[q++]<<8|r[q++]<<16|r[q++]<<24)>>>0;nb=r[q++];ob=r[q++]<<24>>24;pb=r[q++]|r[q++]<<8;qb=r[q++]|r[q++]<<8;var Sa=new Int16Array((new Uint8Array(r.subarray(h.h.offset+2*ua,h.h.offset+2*mb))).buffer);va-=ua;wa-=ua;if(0<ha){for(var P=Sa,rb=ha,xa=void 0,ia=void 0,sb=void 0,Ta=void 0,tb=1;22050>rb;){xa=new Int16Array(2*P.length);ia=Ta=0;for(sb=P.length;ia<sb;++ia)xa[Ta++]=P[ia],xa[Ta++]=P[ia];P=xa;tb*=2;rb*=2}kb=P;ta=tb;Sa=kb;ha*=ta;va*=ta;wa*=ta}qc.push(Sa);rc.push({wa:lb,qa:va,ea:wa,sampleRate:ha,
ka:nb,la:ob,va:pb,xa:qb})}h.a=null;var Q=h.l,K=h.m,Ua=[],ub,vb,Va,wb,H,xb,F,yb;H=0;for(xb=Q.length;H<xb;++H){ub=Q[H].ba;vb=Q[H+1]?Q[H+1].ba:K.length;Va=[];F=ub;for(yb=vb;F<yb;++F){var zb=Fa(K[F].ca,K[F+1]?K[F+1].ca:h.f.length,h.f);m=zb.N;n=zb.O;var Ab=Fa(K[F].P,K[F+1]?K[F+1].P:h.g.length,h.g);f=Ab.N;g=Ab.O;Va.push({Z:m,fa:n,ia:f,ja:g});wb=void 0!==m.instrument?m.instrument.C:void 0!==f.instrument?f.instrument.C:null}Ua.push({name:Q[H].na,info:Va,M:Q[H],o:wb})}var ja=h.o,L=h.i,Bb=[],Cb,Db,Wa,M,Eb,
G,Fb;M=0;for(Eb=ja.length;M<Eb;++M){Cb=ja[M].$;Db=ja[M+1]?ja[M+1].$:L.length;Wa=[];G=Cb;for(Fb=Db;G<Fb;++G){var Gb=Fa(L[G].aa,L[G+1]?L[G+1].aa:h.b.length,h.b);d=Gb.N;e=Gb.O;var Hb=Fa(L[G].P,L[G+1]?L[G+1].ga:h.c.length,h.c);b=Hb.N;c=Hb.O;Wa.push({Z:d,fa:e,ia:b,ja:c})}Bb.push({name:ja[M].ha,info:Wa})}var ya=[],za,I,Aa,Ba,Ca,Ib,Da,Jb;Ca=0;for(Ib=Ua.length;Ca<Ib;++Ca)if(I=Ua[Ca],Ba=I.M.ma,"number"===typeof I.o&&(Aa=Bb[I.o],"EOI"!==Aa.name.replace(/\0*$/,"")))for(void 0===ya[I.M.K]&&(ya[I.M.K]=[]),za=
ya[I.M.K],za[Ba]=[],za[Ba].name=I.name,Da=0,Jb=Aa.info.length;Da<Jb;++Da){var Kb=h,Lb=za[Ba],k=Aa.info[Da].Z,Xa=void 0,R=void 0,Mb=void 0,Nb=void 0,Ob=void 0,Pb=void 0,Qb=void 0,Rb=void 0,Sb=void 0,Tb=void 0,Ub=void 0,Vb=void 0,Wb=void 0,Xb=void 0,Yb=void 0,Ya=void 0,Za=void 0,E=void 0,Zb=void 0;if(void 0!==k.keyRange&&void 0!==k.sampleID)for(Mb=S(k,"delayVolEnv",-12E3),Nb=S(k,"attackVolEnv",-12E3),Ob=S(k,"holdVolEnv",-12E3),Pb=S(k,"decayVolEnv",-12E3),Qb=S(k,"sustainVolEnv"),Rb=S(k,"releaseVolEnv",
-12E3),Sb=S(k,"delayModEnv",-12E3),Tb=S(k,"attackModEnv",-12E3),Ub=S(k,"holdModEnv",-12E3),Vb=S(k,"decayModEnv",-12E3),Wb=S(k,"sustainModEnv"),Xb=S(k,"releaseModEnv",-12E3),Yb=S(k,"coarseTune")+S(k,"fineTune")/100,Ya=S(k,"scaleTuning",100)/100,Za=S(k,"freqVibLFO"),E=k.keyRange.G,Zb=k.keyRange.F;E<=Zb;++E)Lb[E]||(Xa=S(k,"sampleID"),R=Kb.pa[Xa],Lb[E]={sample:Kb.oa[Xa],sampleRate:R.sampleRate,sampleModes:S(k,"sampleModes"),basePlaybackRate:Math.pow(Math.pow(2,1/12),(E-S(k,"overridingRootKey",R.ka)+Yb+
R.la/100)*Ya),modEnvToPitch:S(k,"modEnvToPitch")/100,scaleTuning:Ya,start:32768*S(k,"startAddrsCoarseOffset")+S(k,"startAddrsOffset"),end:32768*S(k,"endAddrsCoarseOffset")+S(k,"endAddrsOffset"),loopStart:R.qa+32768*S(k,"startloopAddrsCoarseOffset")+S(k,"startloopAddrsOffset"),loopEnd:R.ea+32768*S(k,"endloopAddrsCoarseOffset")+S(k,"endloopAddrsOffset"),volDelay:Math.pow(2,Mb/1200),volAttack:Math.pow(2,Nb/1200),volHold:Math.pow(2,Ob/1200)*Math.pow(2,(60-E)*S(k,"keynumToVolEnvHold")/1200),volDecay:Math.pow(2,
Pb/1200)*Math.pow(2,(60-E)*S(k,"keynumToVolEnvDecay")/1200),volSustain:Qb/1E3,volRelease:Math.pow(2,Rb/1200),modDelay:Math.pow(2,Sb/1200),modAttack:Math.pow(2,Tb/1200),modHold:Math.pow(2,Ub/1200)*Math.pow(2,(60-E)*S(k,"keynumToModEnvHold")/1200),modDecay:Math.pow(2,Vb/1200)*Math.pow(2,(60-E)*S(k,"keynumToModEnvDecay")/1200),modSustain:Wb/1E3,modRelease:Math.pow(2,Xb/1200),initialFilterFc:S(k,"initialFilterFc",13500),modEnvToFilterFc:S(k,"modEnvToFilterFc"),initialFilterQ:S(k,"initialFilterQ"),reverbEffectSend:S(k,
"reverbEffectSend"),initialAttenuation:S(k,"initialAttenuation"),freqVibLFO:Za?8.176*Math.pow(2,Za/1200):void 0})}return ya}function S(a,b,c){void 0===c&&(c=0);return a[b]?a[b].C:c}$a.prototype.connect=function(){this.J.connect(this.i);this.i.connect(this.c.destination);this.B&&jb(this)};function jb(a){a.i.connect(a.D);a.D.connect(a.s);a.s.connect(a.c.destination)}function $b(a,b){a.i.gain.value=b/16384*a.da}var ac="Instrument;Vol;Pan;Bend;Range;GM Mode".split(";");
function bc(a){var b=a.a=l.window.document.createElement("table"),c=l.window.document.createElement("thead"),d=l.window.document.createElement("tbody"),e,f,g,m,n,h;c.appendChild(cc(ac,!0));for(h=0;16>h;++h){e=cc(ac.length+128,!1);d.appendChild(e);f=e.querySelector("td:nth-child(1)");g=l.window.document.createElement("input");g.setAttribute("type","checkbox");g.addEventListener("change",function(a,b){return function(){var c=this.checked,d=a.f[b],e;if(a.R[b]=c)for(c=0,e=d.length;c<e;++c)d[c].b.disconnect(0);
else for(c=0,e=d.length;c<e;++c)d[c].connect()}}(a,h),!1);f.appendChild(g);m=l.window.document.createElement("select");for(g=0;128>g;++g){var v=9!==h?ab[g]:bb[g];n=l.window.document.createElement("option");""!==v&&(n.textContent=v,n.value=g,m.appendChild(n))}f.appendChild(m);m.addEventListener("change",function(a,b){return function(c){eb(a,b,c.target.value)}}(a,h),!1);m.selectedIndex=a.h[h];e=e.querySelectorAll("td:nth-last-child(-n+128)");for(g=0;128>g;++g)e[g].addEventListener("mousedown",function(a,
b,c){return function(d){d.preventDefault();a.W=!0;dc(a,b,c,127)}}(a,h,g)),e[g].addEventListener("mouseover",function(a,b,c){return function(d){d.preventDefault();a.W&&dc(a,b,c,127)}}(a,h,g)),e[g].addEventListener("mouseout",function(a,b,c){return function(d){d.preventDefault();ec(a,b,c)}}(a,h,g)),e[g].addEventListener("mouseup",function(a,b,c){return function(d){d.preventDefault();a.W=!1;ec(a,b,c)}}(a,h,g))}b.appendChild(c);b.appendChild(d);return b}
function cc(a,b){var c=l.window.document.createElement("tr"),d,e=a instanceof Array,f,g=e?a.length:a;for(f=0;f<g;++f)d=l.window.document.createElement(b?"th":"td"),d.textContent=e&&void 0!==a[f]?a[f]:"",b&&g===f+1&&d.setAttribute("colspan",129),c.appendChild(d);return c}
function dc(a,b,c,d){var e=fc(a,b),f=a.I[e],g=f[a.h[b]];if(a.a){a.a.querySelector("thead > tr:first-child > th:nth-child(6)").innerText=a.g?"XG Mode":a.j?"GS Mode":"GM Mode";var m=a.a.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child("+(ac.length+c)+")");m.classList.add("note-on");m.style.opacity=d/127}void 0===g&&(g=f[0],l.console.warn("instrument not found: bank=%s instrument=%s channel=%s",e,a.h[b],b));f=g[c];if(void 0===f)l.console.warn("instrument not found: bank=%s instrument=%s channel=%s key=%s",
e,a.h[b],b,c);else{e=a.S[b]-64;f.channel=b;f.key=c;f.velocity=d;f.panpot=e/(0>e?64:63);f.volume=a.V[b]/127;f.pitchBend=a.T[b]-8192;f.expression=a.v[b];f.pitchBendSensitivity=a.A[b];f.mute=a.R[b];f.releaseTime=a.U[b];a.b[b]&&(g.volume*=a.l[c]/127);c=new Ga(a.c,a.i,f);var n=c.c;d=c.o;var h=c.u,v,z,x,g=c.c.currentTime,y=g+d.volDelay,e=g+d.modDelay,C=y+d.volAttack+d.volHold,f=y+d.modAttack+d.modHold,J=C+d.volDecay,m=f+d.modDecay;z=d.loopStart/c.sampleRate;x=d.loopEnd/c.sampleRate;var O=d.start/c.sampleRate,
D,h=h.subarray(0,h.length+d.end);v=c.H=n.createBuffer(1,h.length,c.sampleRate);v.getChannelData(0).set(h);h=c.j=n.createBufferSource();h.buffer=v;h.loop=1===(d.sampleModes&1);h.loopStart=z;h.loopEnd=x;Ja(c,c.A);v=n.createPanner();z=c.b=n.createGain();x=z.gain;c.a=n.createGain();c.a.gain.value=c.g/127;n=c.w=n.createBiquadFilter();n.type="lowpass";v.panningModel="equalpower";v.setPosition(Math.sin(c.m*Math.PI/2),0,Math.cos(c.m*Math.PI/2));D=c.J/127*c.D*(1-d.initialAttenuation/1E3);0>D&&(D=0);x.setValueAtTime(0,
g);x.setValueAtTime(0,y);x.setValueAtTime(D,C);x.linearRampToValueAtTime(D*(1-d.volSustain),J);n.Q.setValueAtTime(Math.pow(10,d.initialFilterQ/200),g);y=Ha(d.initialFilterFc);C=Ha(d.initialFilterFc+d.modEnvToFilterFc);J=y+(C-y)*(1-d.modSustain);n.frequency.setValueAtTime(y,g);n.frequency.setValueAtTime(y,e);n.frequency.setValueAtTime(C,f);n.frequency.linearRampToValueAtTime(J,m);h.connect(n);n.connect(v);v.connect(c.a);c.a.connect(z);d.mute||c.connect();h.start(0,O);a.f[b].push(c)}}
function ec(a,b,c){fc(a,b);var d=a.f[b],e,f=a.w[b];a.a&&(a=a.a.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child("+(c+ac.length)+")"),a.classList.remove("note-on"),a.style.opacity=1);a=0;for(b=d.length;a<b;++a)e=d[a],e.h===c&&(e.l=!0,f||(Ia(e),d.splice(a,1),--a,--b))}function gc(a,b,c){var d=a.f[b];if(!(a.w[b]=!(64>c)))for(b=0,c=d.length;b<c;++b)a=d[b],a.l&&(Ia(a),d.splice(b,1),--b,--c)}
function eb(a,b,c){a.a&&(a.a.querySelector("tbody > tr:nth-child("+(b+1)+") > td:first-child > select").value=c);a.h[b]=c}function fb(a,b,c){a.a&&(a.a.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(2)").textContent=c);a.V[b]=c}function hc(a,b,c){var d,e,f=a.f[b];d=0;for(e=f.length;d<e;++d){var g=f[d];g.a.gain.value=(g.g=c)/127}a.v[b]=c}function gb(a,b,c){a.a&&(a.a.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(3)").textContent=c);a.S[b]=c}
function hb(a,b,c,d){c=c&127|(d&127)<<7;var e,f=a.f[b],g=c-8192;a.a&&(a.a.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(4)").textContent=g);d=0;for(e=f.length;d<e;++d)Ja(f[d],g);a.T[b]=c}function ib(a,b,c){a.a&&(a.a.querySelector("tbody > tr:nth-child("+(b+1)+") > td:nth-child(5)").textContent=c);a.A[b]=c}
function fc(a,b){var c=a.u[b];if(9===b)return a.b[9]=!0,a.g?127:128;if(a.g){if(64===c?c=125:0!==a.m[b]&&0!==c&&126!==c&&127!==c&&(c=a.m[b]),126===c||127===c)a.b[b]=!0}else a.j?(c=0,a.b[b]&&(c=128)):c=0;return c};function T(a){this.j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.g=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.A=this.v.bind(this);this.a=!0;this.Y=void 0!==a.Y;l.window.addEventListener("DOMContentLoaded",function(){this.u=!0}.bind(this),!1)}
T.prototype.s=function(a){this.u?tc(this,a):l.window.addEventListener("DOMContentLoaded",function c(){l.window.removeEventListener("DOMContentLoaded",c,!1);tc(this,a)}.bind(this),!1);l.window.opener?this.h=l.window.opener:l.window.parent!==l.window&&(this.h=l.window.parent)};
function tc(a,b){var c,d=a.h;a.L();c=a.c=new XMLHttpRequest;c.open("GET",b,!0);c.responseType="arraybuffer";c.addEventListener("load",function(a){var b=new Uint8Array(a.target.response);this.m(b);"function"===typeof this.l&&this.l(a.target.response);this.c=null}.bind(a),!1);c.onabort=function(){this.L()};c.addEventListener("progress",function(a){a.lengthComputable&&void 0!==d&&d.postMessage("link,progress,"+a.loaded+","+a.total,"*")}.bind(a),!1);c.send()}
T.prototype.w=function(a){var b=this.b;b.B!==a&&(b.D.disconnect(0),b.s.disconnect(0),(b.B=a)&&jb(b))};T.prototype.L=function(){this.c&&(this.c.abort(),this.c=null)};T.prototype.m=function(a){var b;this.L();this.b?(b=this.b,b.H=a,b.X=new la(a),b.I=db(b)):(b=this.b=new $a(a),this.Y||l.window.document.body.appendChild(bc(b)),cb(b),a=b,a.connect(),a.J.start(0),$b(a,16383),l.window.addEventListener("message",this.A,!1));l.window.postMessage("link,ready","*")};
T.prototype.v=function(a){var b="function"===typeof a.data.split?a.data.split(","):"",c=""!==b?b.shift():"";a=this.h;switch(c){case "midi":uc(this,b.map(function(a){return parseInt(a,16)}));break;case "link":if(void 0!==a)switch(b=b.shift(),b){case "reqpatch":a.postMessage("link,patch","*");break;case "setpatch":case "ready":a.postMessage("link,ready","*");break;default:l.console.error("unknown link message:",b)}}};T.prototype.B=function(a){this.l=a};
function uc(a,b){var c=b[0]&15,d=a.b;switch(b[0]&240){case 128:ec(d,c,b[1]);break;case 144:0<b[2]?dc(d,c,b[1],b[2]):ec(d,c,b[1]);break;case 176:switch(b[1]){case 0:d.u[c]=b[2];break;case 6:if(a.a)switch(a.g[c]){case 0:switch(a.f[c]){case 0:ib(d,c,b[2])}}else switch(a.j[c]){case 26:d.l[a.i[c]]=b[2]}break;case 38:if(a.a)switch(a.g[c]){case 0:switch(a.f[c]){case 0:ib(d,c,d.A[c]+b[2]/100)}}break;case 7:fb(d,c,b[2]);break;case 10:gb(d,c,b[2]);break;case 120:for(var e=d.f[c],f;0<e.length;)f=e.shift(),ec(d,
c,f.h),Ia(f),f.b.disconnect(0);break;case 121:hc(d,c,127);hb(d,c,0,64);gc(d,c,0);break;case 32:d.m[c]=b[2];break;case 98:a.a=!1;a.i[c]=b[2];break;case 99:a.a=!1;a.j[c]=b[2];break;case 100:a.a=!0;a.f[c]=b[2];break;case 101:a.a=!0;a.g[c]=b[2];break;case 64:gc(d,c,b[2]);break;case 11:hc(d,c,b[2]);break;case 74:d.U[c]=b[2]}break;case 192:eb(d,c,b[1]);break;case 224:hb(d,c,b[1],b[2]);break;case 240:switch(b[1]){case 126:127===b[2]&&9===b[3]&&1===b[4]&&(d.g=!1,d.j=!1,cb(d));break;case 127:switch(b[3]){case 4:switch(b[4]){case 1:$b(d,
b[5]+(b[6]<<7))}}}switch(b[2]){case 67:8===b[5]&&(d.b[b[6]]=!0);switch(b[7]){case 4:$b(d,b[8]<<7);break;case 126:cb(d),d.g=!0}break;case 65:switch(b[8]){case 4:$b(d,b[9]<<7);break;case 127:cb(d);d.j=!0;break;case 21:c=b[7]-15,0===c?d.b[9]=!0:10<=c?d.b[c-1]=!0:d.b[c]=!0}}break;default:d.b[9]=!0}};p("SoundFont.WebMidiLink",T);p("SoundFont.WebMidiLink.prototype.setup",T.prototype.s);p("SoundFont.WebMidiLink.prototype.loadSoundFont",T.prototype.m);p("SoundFont.WebMidiLink.prototype.cancelLoading",T.prototype.L);p("SoundFont.WebMidiLink.prototype.setLoadCallback",T.prototype.B);p("SoundFont.WebMidiLink.prototype.setReverb",T.prototype.w);}).call(this); //# sourceMappingURL=sf2synth.min.js.map
